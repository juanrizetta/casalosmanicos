<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Casa Rural Los Manicos | Alojamiento Tur칤stico 칔nico</title>
    <meta name="description"
        content="Disfruta de una estancia inolvidable en Casa Rural Los Manicos. Dise침o moderno, todas las comodidades y un entorno espectacular.">
    <link rel="stylesheet" href="css/styles.css">
    <!-- FullCalendar Dependencies -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@6.1.10/index.global.min.js'></script>
    <script src="js/config.js" defer></script>
</head>

<body>

    <header id="main-header">
        <div class="container nav-content">
            <div class="logo">CASA RURAL LOS MANICOS</div>
            <nav class="nav-links">
                <a href="#inicio">Inicio</a>
                <a href="#servicios">Servicios</a>
                <a href="#precios">Precios</a>
                <a href="#disponibilidad">Reservar</a>
                <a href="#contacto">Contacto</a>
            </nav>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section id="inicio" class="hero" style="background-image: url('assets/hero.png');">
            <div class="hero-overlay"></div>
            <div class="hero-content container">
                <h1 id="hero-title">Casa Rural Los Manicos</h1>
                <p id="hero-tagline">Tu Refugio en Moratalla</p>
                <div style="margin-top: 30px;">
                    <a href="#servicios" class="btn">Explorar</a>
                    <a href="#contacto" class="btn btn-outline">Reservar</a>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="container" style="text-align: center; padding: 100px 0;">
            <p style="font-size: 1.2rem; max-width: 800px; margin: 0 auto; line-height: 1.8;" id="site-description">
                Descubre la combinaci칩n perfecta de lujo, confort y naturaleza en un espacio dise침ado para tu descanso.
            </p>
        </section>

        <!-- Services / Carousels -->
        <section id="servicios" class="container">
            <h2 style="text-align: center; margin-bottom: 50px;">Nuestra Propuesta</h2>
            <div id="carousel-grid" class="grid">
                <!-- Data will be injected here by config.js logic -->
            </div>
        </section>

        <!-- Pricing Section -->
        <section id="precios" style="background: var(--accent); padding: 100px 0;">
            <div class="container">
                <h2 style="text-align: center; margin-bottom: 20px;" id="pricing-title">Tarifas y Disponibilidad</h2>
                <p style="text-align: center; margin-bottom: 50px; color: var(--text-muted);" id="pricing-desc">Precios
                    por noche dise침ados para adaptarse a tu grupo. Estancia m칤nima: 2 noches.</p>

                <div id="pricing-grid" class="pricing-grid">
                    <!-- Data will be injected here by config.js logic -->
                </div>

                <div class="pricing-footer">
                    <p>* Los precios pueden variar en puentes y festivos especiales. Cons칰ltanos directamente.</p>
                </div>
            </div>
        </section>

        <!-- Calendar Section -->
        <section id="disponibilidad" class="container" style="padding: 100px 0;">
            <h2 style="text-align: center; margin-bottom: 20px;">Consulta Nuestra Disponibilidad</h2>
            <p style="text-align: center; margin-bottom: 50px; color: var(--text-muted);">Planifica tu estancia con
                nuestro calendario de reservas.</p>
            <div id="calendar"></div>
        </section>

        <!-- Contact -->
        <section id="contacto" class="container" style="text-align: center;">
            <h2>Contacto y Reservas</h2>
            <p style="margin-bottom: 40px; color: var(--text-muted);">쯊ienes alguna duda? Estamos aqu칤 para ayudarte a
                planear tu estancia.</p>
            <div style="max-width: 600px; margin: 0 auto;">
                <p>游늸 Calle Luengo Bajo 20, Moratalla, Murcia</p>
                <p>游 +34 600 000 000</p>
                <p>九괦잺 casalosmanicos@gmail.es</p>
                <br>
                <a href="mailto:casalosmanicos@gmail.com" class="btn">Enviar un Email</a>
            </div>
        </section>
    </main>

    <footer style="padding: 40px 0; text-align: center; border-top: 1px solid var(--accent); color: var(--text-muted);">
        <p>&copy; 2026 Casa Rural Los Manicos. Todos los derechos reservados.</p>
    </footer>

    <script>
        // Header scroll effect
        window.addEventListener('scroll', () => {
            const header = document.getElementById('main-header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Initialize dynamic content
        function initApp() {
            try {
                console.log("Iniciando Casa Rural Los Manicos App...");

                if (typeof CONFIG === 'undefined') {
                    throw new Error("CONFIG no est치 definido. Comprueba que js/config.js se carga correctamente.");
                }

                // Update Title and Logo
                document.title = `${CONFIG.title} | Alojamiento Tur칤stico 칔nico`;
                const logo = document.querySelector('.logo');
                if (logo) logo.innerText = CONFIG.title.toUpperCase();

                // Render Hero content
                const heroTitle = document.getElementById('hero-title');
                const heroTagline = document.getElementById('hero-tagline');
                const siteDesc = document.getElementById('site-description');

                if (heroTitle) heroTitle.innerText = CONFIG.title;
                if (heroTagline) heroTagline.innerText = CONFIG.tagline;
                if (siteDesc) siteDesc.innerText = CONFIG.description;

                // Render Pricing labels
                const priceTitle = document.getElementById('pricing-title');
                const priceDesc = document.getElementById('pricing-desc');

                if (CONFIG.pricing) {
                    if (priceTitle) priceTitle.innerText = CONFIG.pricing.title;
                    if (priceDesc) priceDesc.innerText = CONFIG.pricing.description;
                }

                // Update Contact details
                const contactDiv = document.querySelector('#contacto div');
                if (contactDiv && CONFIG.contact) {
                    contactDiv.innerHTML = `
                        <p>游늸 ${CONFIG.contact.address}</p>
                        <p>游 ${CONFIG.contact.phone}</p>
                        <p>九괦잺 ${CONFIG.contact.email}</p>
                        <br>
                        <a href="mailto:${CONFIG.contact.email}" class="btn">Enviar un Email</a>
                    `;
                }

                // Sync Carousels, Pricing and Calendar
                console.log("Cargando carruseles, precios y calendario...");
                initCarousels();
                initPricing();
                initCalendar();

            } catch (e) {
                console.error("Error inicializando la web:", e);
                // Fallback visual si falla algo cr칤tico
                document.body.prepend(document.createComment("Error: " + e.message));
            }
        }

        function initCarousels() {
            const grid = document.getElementById('carousel-grid');
            if (!grid) return;

            CONFIG.sections.forEach(section => {
                const card = document.createElement('div');
                card.className = 'card';

                let slidesHtml = section.images.map((img, idx) => `
                    <div class="carousel-slide ${idx === 0 ? 'active' : ''}" style="background-image: url('${img}')"></div>
                `).join('');

                let dotsHtml = section.images.map((_, idx) => `
                    <button class="carousel-dot ${idx === 0 ? 'active' : ''}" onclick="setSlide('${section.id}', ${idx})"></button>
                `).join('');

                card.innerHTML = `
                    <div id="${section.id}" class="carousel-container">
                        ${slidesHtml}
                        <button class="carousel-btn carousel-prev" onclick="moveSlide('${section.id}', -1)">&#10094;</button>
                        <button class="carousel-btn carousel-next" onclick="moveSlide('${section.id}', 1)">&#10095;</button>
                        <div class="carousel-controls">
                            ${dotsHtml}
                        </div>
                    </div>
                    <div class="card-body">
                        <h3>${section.title}</h3>
                        <p>${section.text}</p>
                    </div>
                `;
                grid.appendChild(card);

                // Auto slide
                setInterval(() => moveSlide(section.id, 1), 5000 + Math.random() * 2000);
            });
        }

        function initPricing() {
            const grid = document.getElementById('pricing-grid');
            if (!grid) return;

            CONFIG.pricing.seasons.forEach(season => {
                const card = document.createElement('div');
                card.className = 'pricing-card';

                const tableRows = season.ranges.map(range => `
                    <tr>
                        <td>${range.persons}</td>
                        <td>${range.price}</td>
                    </tr>
                `).join('');

                card.innerHTML = `
                    <h3>${season.name}</h3>
                    <table class="pricing-table">
                        ${tableRows}
                    </table>
                `;
                grid.appendChild(card);
            });
        }

        function moveSlide(id, direction) {
            const container = document.getElementById(id);
            const slides = container.querySelectorAll('.carousel-slide');
            const dots = container.querySelectorAll('.carousel-dot');
            let currentIdx = Array.from(slides).findIndex(s => s.classList.contains('active'));

            slides[currentIdx].classList.remove('active');
            dots[currentIdx].classList.remove('active');

            currentIdx = (currentIdx + direction + slides.length) % slides.length;

            slides[currentIdx].classList.add('active');
            dots[currentIdx].classList.add('active');
        }

        function setSlide(id, index) {
            const container = document.getElementById(id);
            const slides = container.querySelectorAll('.carousel-slide');
            const dots = container.querySelectorAll('.carousel-dot');

            slides.forEach(s => s.classList.remove('active'));
            dots.forEach(d => d.classList.remove('active'));

            slides[index].classList.add('active');
            dots[index].classList.add('active');
        }

        function initCalendar() {
            const calendarEl = document.getElementById('calendar');
            if (!calendarEl || !CONFIG.calendar || !CONFIG.calendar.apiKey || CONFIG.calendar.apiKey === "YOUR_GOOGLE_API_KEY") {
                console.warn("Calendario no configurado o API Key pendiente.");
                if (calendarEl) calendarEl.innerHTML = "<p style='text-align: center; color: var(--text-muted); padding: 50px;'>Calendario pendiente de configuraci칩n (API Key / ID necesarios).</p>";
                return;
            }

            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                locale: 'es',
                googleCalendarApiKey: CONFIG.calendar.apiKey,
                events: {
                    googleCalendarId: CONFIG.calendar.googleCalendarId
                },
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: ''
                },
                buttonText: {
                    today: 'Hoy'
                }
            });

            calendar.render();
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>